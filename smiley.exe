import os
import time
import random

import tweepy
from dotenv import load_dotenv

# --------------------------------------------------
# load environment
# --------------------------------------------------
load_dotenv()

API_KEY = os.getenv("X_API_KEY")
API_SECRET = os.getenv("X_API_SECRET")
ACCESS_TOKEN = os.getenv("X_ACCESS_TOKEN")
ACCESS_SECRET = os.getenv("X_ACCESS_SECRET")

POST_INTERVAL = int(os.getenv("POST_INTERVAL", 3600))  # seconds

# --------------------------------------------------
# minimal post corpus
# edit freely
# --------------------------------------------------
POSTS = [
    "signal intact",
    "process continues",
    "still running",
    "no anomaly detected",
    "state unchanged",
    "system active"
]

# --------------------------------------------------
# auth
# --------------------------------------------------
def authenticate():
    auth = tweepy.OAuth1UserHandler(
        API_KEY,
        API_SECRET,
        ACCESS_TOKEN,
        ACCESS_SECRET
    )
    return tweepy.API(auth)

# --------------------------------------------------
# main loop
# --------------------------------------------------
def main():
    api = authenticate()

    if not POSTS:
        return

    while True:
        text = random.choice(POSTS)
        api.update_status(status=text)
        time.sleep(POST_INTERVAL)

# --------------------------------------------------
# entry
# --------------------------------------------------
if __name__ == "__main__":
    main()
